<!DOCTYPE html>
<html><head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>テスト</title>
	<style>
		body {
			margin: 0;
			overflow: hidden;
		}
	</style>
</head><body>
	<div>HelloWorld</div>
	<button id="button">test</button>
	<script type="text/javascript" src="wasm_exec.js"></script>
	<script type="text/javascript" >
// ----------------------------------------------------------------
// ----------------------------------------------------------------
// ----------------------------------------------------------------

document.addEventListener("DOMContentLoaded", event => {
	const go = new Go();

	let module = null;
	let instance = null;
	WebAssembly.instantiateStreaming(fetch("dist/test.wasm"), go.importObject).then(result => {
		module = result.module;
		instance = result.instance;
	});

	document.getElementById("button").addEventListener("click", async event => {
		if (module === null || instance === null) { return; }
		await go.run(instance);
		instance = await WebAssembly.instantiate(module, go.importObject);
	});
});

// ----------------------------------------------------------------
// ----------------------------------------------------------------
// ----------------------------------------------------------------
	</script>
</body></html>
